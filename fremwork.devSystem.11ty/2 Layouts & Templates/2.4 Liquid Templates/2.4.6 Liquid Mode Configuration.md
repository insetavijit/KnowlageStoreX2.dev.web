| **Subtopic** | **Focus & Purpose** | **Key Concepts / Details** | **One-Line Recall** |
| :--- | :--- | :--- | :--- |
| **2.4.6 Liquid Mode Configuration** | Engine Tuning | `setLiquidOptions`; strict mode; timezone; date parsing | Tuning the Liquid engine. |
| **[[2.4.6.1 liquidOptions]]** | Setup | `eleventyConfig.setLiquidOptions(opts)`; Main config hook | The control panel. |
| **[[2.4.6.2 Strict Mode]]** | Validation | `strict_filters`, `strict_variables`; failing builds on errors | Stop if there is a typo. |
| **[[2.4.6.3 Timezone Handling]]** | Dates | `timezoneOffset`; preserving dates across server locales | Handling time is hard. |
| **[[2.4.6.4 Dynamic Partials]]** | Feature | `dynamicPartials: true/false`; Quoted includes vs variable includes | Turning on "Jekyll Mode". |
| **[[2.4.6.5 Custom Tags]]** | Extension | `addLiquidTag`; extending the language syntax | Adding your own tags. |

# 2.4.6 Liquid Mode Configuration

Eleventy uses the `liquidjs` library to compile Liquid templates. It exposes the underlying configuration options of that library so you can tune the engine's behavior, specifically regarding strictness and date handling.

---

## 2.4.6.1 Liquid Options Hook

Content in `.eleventy.js`:

```javascript
module.exports = function(eleventyConfig) {
  eleventyConfig.setLiquidOptions({
    dynamicPartials: true,
    strict_filters: false,
    strict_variables: false
  });
};
```

This passes the configuration object directly to the `Liquid()` constructor.

---

## 2.4.6.2 Strict Mode

By default, Liquid is lenient. If you type `{{ user.nmae }}` (typo), it prints nothing. If you want to catch these errors during build time, enable strict mode.

*   `strict_variables: true`: Throws error if variable is undefined.
*   `strict_filters: true`: Throws error if filter doesn't exist.

**Recommendation**: Enable these locally to catch bugs, but maybe disable them in production if you want a resilient build.

---

## 2.4.6.3 Timezone Handling

LiquidJS tries to be smart about dates, but this can cause issues where "2024-01-01" becomes "2023-12-31" depending on the server's timezone.

You can set a generic offset:
```javascript
eleventyConfig.setLiquidOptions({
  timezoneOffset: 0 // UTC
});
```

This helps ensure that dates rendered on your local machine match dates rendered on the CI/CD server.

---

## 2.4.6.4 Dynamic Partials

This setting controls how the `include` tag parses its arguments.

*   `dynamicPartials: true` (Default): `{% include name %}` looks for a variable called `name`. `{% include "header.liquid" %}` looks for the file.
*   `dynamicPartials: false` (Jekyll Mode): `{% include header.liquid %}` treats the unquoted string as a literal filename.

If migrating from Jekyll, setting this to `false` can save you from rewriting thousands of includes, but `true` is the modern standard.

---

## 2.4.6.5 Custom Tags

You can add custom logic tags to Liquid.

```javascript
eleventyConfig.addLiquidTag("upper", function(liquidEngine) {
  return {
    parse: function(tagToken, remainTokens) {
      this.str = tagToken.args; // Parsing arguments
    },
    render: function(scope, hash) {
      return Promise.resolve(this.str.toUpperCase());
    }
  };
});
```

Usage: `{% upper "hello" %}` -> "HELLO"

*Note: For almost all use cases, Shortcodes (`addShortcode`) are simpler and preferred.*

---

## Quick Reference

| Option | Default | Effect |
| :--- | :--- | :--- |
| `strict_variables` | `false` | Error on undefined vars. |
| `strict_filters` | `false` | Error on typo filters. |
| `dynamicPartials` | `true` | Quoted string = File; Unquoted = Var. |
| `timezoneOffset` | `0` | Align server timezones. |
