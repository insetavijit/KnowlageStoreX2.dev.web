| **Subtopic** | **Focus & Purpose** | **Key Concepts / Details** | **One-Line Recall** |
| :--- | :--- | :--- | :--- |
| **2.6.4 Dynamic Includes** | Polymorphism | Variable paths; Component loops; Page Builders | Deciding what to render at runtime. |
| **[[2.6.4.1 The Variable Include]]** | Syntax | `{% include myVar %}`; path calculation logic | The path is just a string. |
| **[[2.6.4.2 The Component Loop]]** | Pattern | Iterating over a "blocks" array and including files matching `type` | The Page Builder architecture. |
| **[[2.6.4.3 Constructing Paths]]** | Logic | Concatenating strings: `("components/" + type + ".njk")` | Building the filename. |
| **[[2.6.4.4 Liquid Differences]]** | Config | `dynamicPartials: true` is required for this to work in Liquid | Liquid needs a setting flipped. |
| **[[2.6.4.5 Missing File Safety]]** | Robustness | `ignore missing` flag prevents crashes on bad data | Skip it if it's gone. |

# 2.6.4 Dynamic Includes

Static sites are not always simple documents. Modern CMS setups (Headless CMS) often provide "Page Builders" where an editor defines a list of components: "Hero", then "Text", then "Gallery", then "CTA".

To handle this, you need **Dynamic Includes**: determining which template to load based on the data.

---

## 2.6.4.1 The Variable Include

Both Nunjucks and Liquid allow you to pass a variable to the include tag instead of a string literal.

```html
{% set componentName = "card.njk" %}
{% include componentName %}
```

This simple mechanism is the foundation of all modular architecture in Eleventy.

---

## 2.6.4.2 The Component Loop (Page Builder Pattern)

Imagine your Front Matter has a `sections` array:

```yaml
sections:
  - type: "hero"
    title: "Welcome"
  - type: "gallery"
    images: ["a.jpg", "b.jpg"]
```

You can render this page dynamically:

```html
{% for section in sections %}
  {% set templatePath = "sections/" + section.type + ".njk" %}
  
  {% include templatePath ignore missing %}
  
{% endfor %}
```

This loop will look for `_includes/sections/hero.njk` and `_includes/sections/gallery.njk` and render them in order.

---

## 2.6.4.3 Constructing Paths (String Concatenation)

Each engine handles string concatenation differently.

**Nunjucks**:
```html
{% set path = "components/" + type + ".njk" %}
```
(Uses the `+` operator, similar to JS).

**Liquid**:
```liquid
{% capture path %}components/{{ type }}.liquid{% endcapture %}
```
(Liquid often requires `capture` to build complex strings, though `append` filter works for simple cases).

---

## 2.6.4.4 Liquid Configuration

As noted in **[[2.4.6 Liquid Mode Configuration]]**, standard Liquid behaves differently with Includes.

To use variables in Includes in Liquid, you must ensure:
1.  **Quotes matter**: `{% include "file" %}` is a string. `{% include file %}` is a variable.
2.  **Config**: `dynamicPartials: true` (default in 11ty) must be enabled.

---

## 2.6.4.5 Missing File Safety

In a dynamic setup, data errors happen. An editor might select a "Carousel" component, but you haven't built `carousel.njk` yet.

Without protection, the build will **Fail** with "Template not found".

**The Fix**:
Always use `ignore missing` when including dynamically generated paths.

```html
{% include myPath ignore missing %}
```

This allows the build to continue silently (or with a custom log message if you add logic to check existence first).

---

## Quick Reference

| Feature | Nunjucks | Liquid |
| :--- | :--- | :--- |
| **Concat** | `"a" + "b"` | `capture` block |
| **Syntax** | `{% include var %}` | `{% include var %}` |
| **Safety** | `ignore missing` | (Varies, usually ignored) |
| **Context** | passes loop var | passes loop var |
