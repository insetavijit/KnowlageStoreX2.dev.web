| **Subtopic** | **Focus & Purpose** | **Key Concepts / Details** | **One-Line Recall** |
| :--- | :--- | :--- | :--- |
| **2.3.1 Variables & Types** | Data Handling | `{% set %}`, primitive types, complex types (Arrays/Objects) | Using memory in templates. |
| **[[2.3.1.1 Declaring Variables]]** | Syntax | `{% set myVar = "value" %}`; creating local variables; `set` block syntax | `{% set x = 1 %}` |
| **[[2.3.1.2 Primitive Types]]** | Basics | Strings (`'text'`), Interpolation (`"Hello, {{name}}"`), Numbers (`123`, `1.5`), Booleans (`true`/`false`) | The atoms of data. |
| **[[2.3.1.3 Complex Types]]** | Structures | Arrays (`['a', 'b']`), Objects (`{key: 'val'}`); accessing via dot/bracket notation | Grouping data together. |
| **[[2.3.1.4 Scoping Rules]]** | Visibility | Variables set inside loops/blocks are locally scoped by default; passing data up | What happens in the loop stays... |
| **[[2.3.1.5 Truthy & Falsy]]** | Logic | Nunjucks truthiness quirks; `0` is truthy, empty string is falsy | Don't trust `if 0`. |

# 2.3.1 Variables & Types in Nunjucks

At its core, Nunjucks is not just a text replacer; it is a logic engine. Understanding how to handle data types and variables is the difference between writing "dumb" templates and "intelligent" layouts.

While Eleventy provides data via the global cascade (Front Matter, Data Files), you often need to create, manipulate, and restructure data *inside* the template itself.

---

## 2.3.1.1 Declaring Variables

The primary tool for creating variables is the `set` tag.

**Inline Set**:
```html
{% set activeClass = "is-active" %}
{% set total = 5 + 10 %}
```

**Block Set (Capturing output)**:
Useful for capturing a large chunk of HTML into a variable.
```html
{% set myComplexHtml %}
  <div class="card">
    <h2>{{ title }}</h2>
    <p>Dynamic Content...</p>
  </div>
{% endset %}

<!-- Output it later -->
{{ myComplexHtml | safe }}
```

---

## 2.3.1.2 Primitive Types

Nunjucks handles standard JavaScript primitives, but with some syntactic differences.

*   **Strings**: Can use single `'` or double `"` quotes.
    *   *Note*: Nunjucks does **not** support template literals (backticks) like JS. You must use concatenation (`"Hello " + name`).
*   **Numbers**: Integers and floats work as expected (`Math` operations work if you create custom filters, but `+ - * / %` are built-in).
*   **Booleans**: `true` and `false` (lowercase).

---

## 2.3.1.3 Complex Types (Arrays & Objects)

You can define arrays and objects directly in your template code.

**Arrays**:
```html
{% set colors = ["red", "green", "blue"] %}
First Color: {{ colors[0] }}
```

**Objects**:
```html
{% set author = { name: "Zach", role: "Creator" } %}
Name: {{ author.name }}
Role: {{ author["role"] }}
```

**Practical Use Case**:
Defining ad-hoc navigation menus inside a layout file.
```html
{% set navItems = [
  { url: "/", label: "Home" },
  { url: "/about/", label: "About" }
] %}
```

---

## 2.3.1.4 Scoping Rules (The "Gotcha")

Nunjucks variable scope is strictly hierarchical. **Variables defined inside a block (loop, if, macro) are not visible outside that block.**

**The Scoping Problem**:
```html
{% set result = "fail" %}

{% if true %}
  {% set result = "pass" %} <!-- Only exists inside this 'if' -->
{% endif %}

{{ result }} <!-- Outputs: "fail" -->
```

This is often frustrating for developers expecting JS `var/let` behavior. To "leak" a variable out, you usually have to use an object reference (since objects are passed by reference) but strict Nunjucks often prevents this. The best practice is to handle logic *before* the output or use custom filters for complex data manipulation.

---

## 2.3.1.5 Truthy & Falsy

Nunjucks logic is similar to JavaScript but has key differences:

*   **Truthy**: `1`, `"string"`, `[]`, `{}` (Empty arrays/objects are truthy!).
*   **Falsy**: `false`, `undefined`, `null`, `""` (Empty string).
*   **The Number 0**: In Nunjucks, **`0` is Truthy**.
    *   `{% if 0 %}` evaluates to **TRUE**.
    *   This is distinct from JavaScript where `0` is false.

---

## Quick Reference

| Concept | Key Point |
| :--- | :--- |
| **`{% set %}`** | Use for creating variables. Inline for values, Block for HTML capture. |
| **Scope** | Inner blocks cannot easily write to outer variables. Plan accordingly. |
| **Interpolation** | `{{ var }}` inputs data. Use filters `\|` to modify. |
| **Numbers** | `0` is Truthy. Be careful when checking counts. Use `length` specifically. |
| **Objects** | Create with standard JS syntax `{ key: val }`. |
