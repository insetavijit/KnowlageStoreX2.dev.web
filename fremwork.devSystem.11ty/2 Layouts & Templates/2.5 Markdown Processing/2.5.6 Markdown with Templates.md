| **Subtopic** | **Focus & Purpose** | **Key Concepts / Details** | **One-Line Recall** |
| :--- | :--- | :--- | :--- |
| **2.5.6 Markdown with Templates** | Hybrid Rendering | `markdownTemplateEngine`; mixing Logic + Content | Variables inside Markdown. |
| **[[2.5.6.1 markdownTemplateEngine]]** | Configuration | Setting default (e.g., "njk"); Pre-processing MD files | Run Nunjucks -> Then Markdown. |
| **[[2.5.6.2 Logic in Content]]** | Usage | `{{ title }}` or `{% if draft %}` inside `.md` content | Dynamic text in static files. |
| **[[2.5.6.3 Paired Shortcodes]]** | Components | Wrappers accessible in Markdown; `{% callout %}Content{% endcallout %}` | Wrappers for content. |
| **[[2.5.6.4 Double Extensions]]** | Per-File Override | `file.md.njk`; Explicitly defining the chain | Override global defaults. |
| **[[2.5.6.5 The Render Pipeline]]** | Concept | Data Capture -> Template Engine -> Markdown Parser -> Layout | Know the sequence. |

# 2.5.6 Markdown with Templates

By default, a Markdown file is just text. But Eleventy's superpower is that it treats Markdown files as **Templates**. This means you can use Nunjucks or Liquid syntax *inside* your blog posts.

This is controlled by the `markdownTemplateEngine` configuration.

---

## 2.5.6.1 markdownTemplateEngine

In your `.eleventy.js` config, you likely have this line:

```javascript
module.exports = function(eleventyConfig) {
  return {
    markdownTemplateEngine: "njk", // or "liquid"
    htmlTemplateEngine: "njk"
  };
};
```

This tells Eleventy: "When you see an `.md` file, first pass it through the **Nunjucks** engine, and *then* pass the result to the **Markdown** parser."

---

## 2.5.6.2 Logic in Content

Because of this pre-processing, you can do powerful things inside a standard Markdown file.

**Input (`post.md`)**:
```markdown
# Hello {{ user.name }}

Current Date: {{ page.date | date: "%Y-%m-%d" }}

{% if special_offer %}
  **Special Offer:** 50% Off!
{% endif %}
```

**Output**:
```html
<h1>Hello Avis</h1>
<p>Current Date: 2024-01-01</p>
<p><strong>Special Offer:</strong> 50% Off!</p>
```

The Nunjucks engine runs first, resolving variables and logic. The result is plain Markdown string, which is then compiled to HTML.

---

## 2.5.6.3 Paired Shortcodes (Components)

The most common use case is using Shortcodes to inject complex HTML structures without muddying your Markdown.

**Shortcode Definition (.eleventy.js)**:
```javascript
eleventyConfig.addPairedShortcode("callout", function(content, type="info") {
  return `<div class="callout callout-${type}">${content}</div>`;
});
```

**Markdown Usage**:
```markdown
{% callout "warning" %}
  This is a **bold** warning inside a div.
{% endcallout %}
```

**Crucial Note**: The content inside the shortcode is returned as a string. If you want Markdown syntax (`**bold**`) to work *inside* the shortcode, the shortcode must return logic that allows further processing (often handled via `markdown-it` rendering inside the shortcode or relying on the render pipeline).

---

## 2.5.6.4 Double Extensions (Explicit Overrides)

If your global config is set to "njk", but you have one specific file that needs to use Liquid, you can use double extensions.

*   `file.md.liquid`
*   `file.md.njk`
*   `file.md` (Uses global default)

This explicit naming overrides the `markdownTemplateEngine` setting for that specific file.

---

## 2.5.6.5 The Render Pipeline

Understanding the order of operations prevents bugs.

1.  **Data Merge**: Front Matter + Data Files are merged.
2.  **Template Engine (Nunjucks/Liquid)**: Processes the `.md` file content. Variables are replaced. Logic is executed.
3.  **Markdown Parser (Markdown-it)**: The result of step 2 is parsed from MD to HTML.
4.  **Layout Wrapping**: The result of step 3 is injected into `{{ content }}` of the layout file.

---

## Quick Reference

| Config | Value | Effect |
| :--- | :--- | :--- |
| `markdownTemplateEngine` | `"njk"` | `.md` files run Nunjucks first. |
| `markdownTemplateEngine` | `false` | `.md` files are strictly Markdown (faster). |
| `file.md.njk` | (Extension) | Forces Nunjucks processing for this file. |
