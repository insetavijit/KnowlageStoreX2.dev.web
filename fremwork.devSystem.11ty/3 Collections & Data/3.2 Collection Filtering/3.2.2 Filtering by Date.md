| **Subtopic** | **Focus & Purpose** | **Key Concepts / Details** | **One-Line Recall** |
| :--- | :--- | :--- | :--- |
| **3.2.2 Filtering by Date** | Temporal Logic | `item.date`; Future/Past logic; Year grouping | Finding things in time. |
| **[[3.2.2.1 The Date Object]]** | Foundation | `item.date` is a JS `Date()` object; extracted from filename or FM | The timestamp source. |
| **[[3.2.2.2 Future/Past Logic]]** | Comparison | `date > new Date()`; Comparing items against "now" | Hiding future content. |
| **[[3.2.2.3 Grouping by Year]]** | Structure | `date.getFullYear()`; Creating archives (2023, 2024...) | Grouping by year. |
| **[[3.2.2.4 "Recent" Collections]]** | Selection | `.sort().slice(0, 5)`; Getting the 5 newest items | The "Latest News" list. |
| **[[3.2.2.5 Updating "Now"]]** | Pitfall | "Now" is determined at **Build Time**, not Request Time | Static time vs Dynamic time. |

# 3.2.2 Filtering by Date

In a static site, time is frozen. "Now" means "The exact second the build command ran."

Filtering by date allows you to create Archives, "Upcoming Events" lists, and "What's New" sections.

---

## 3.2.2.1 The Date Object

Every collection item has a `date` property.

1.  **Implicit**: `2023-01-01-my-post.md` -> Sets date to Jan 1, 2023.
2.  **Explicit**: `date: 2023-05-20` in Front Matter.
3.  **Fallback**: File creation time (OS dependent).

When you filter, you are comparing standard JavaScript Date objects.

---

## 3.2.2.2 Future vs Past

A common requirement is to hide posts scheduled for the future.

```javascript
eleventyConfig.addCollection("published", (collection) => {
  const now = new Date();
  
  return collection.getFilteredByTag("post").filter((item) => {
    // Only return items where date is in the past
    return item.date <= now;
  });
});
```

**Environment Variables**:
Often you want to see future posts in development but hide them in production.

```javascript
return item.date <= now || process.env.ELEVENTY_ENV !== "production";
```

---

## 3.2.2.3 Grouping by Year

To build an Archive page (e.g., `/2023/`, `/2022/`), you need to group items.

```javascript
eleventyConfig.addCollection("postsByYear", (collection) => {
  const posts = collection.getFilteredByTag("post");
  
  // Use lodash.groupBy or native Reduce
  return _.groupBy(posts, (post) => {
    return post.date.getFullYear();
  });
});
```

**Result**:
```json
{
  "2023": [Post A, Post B],
  "2022": [Post C]
}
```

---

## 3.2.2.4 "Recent" Collections

While `collections.post` gives you *all* posts, you often just want "The Latest 3" for a homepage widget. Creating a dedicated collection for this is more efficient than processing the full list in the template every time.

```javascript
eleventyConfig.addCollection("latestPosts", (collection) => {
  return collection.getFilteredByTag("post")
    .reverse()
    .slice(0, 3);
});
```

---

## 3.2.2.5 The Static Time Trap

Remember: `new Date()` runs when you run `npm run build`.

If you deploy your site on **Monday** with an event listed for **Tuesday**:
*   On Tuesday, the site still thinks it is Monday.
*   On Wednesday, the site still thinks it is Monday.

The "Upcoming Event" will stay "Upcoming" forever until you **rebuild** and **redeploy** the site.

**Solution**:
Trigger nightly builds (Cron Jobs) on your hosting provider (Netlify/Vercel) to ensure "Time" moves forward on your static site.

---

## Quick Reference

| Method | Syntax | Purpose |
| :--- | :--- | :--- |
| **Year** | `date.getFullYear()` | Grouping by year (YYYY). |
| **Month** | `date.getMonth()` | Grouping by month (0-11). |
| **ISO** | `date.toISOString()` | Standard string format. |
| **Timestamp**| `date.getTime()` | Integer for easy math comparison. |
