| **Subtopic** | **Focus & Purpose** | **Key Concepts / Details** | **One-Line Recall** |
| :--- | :--- | :--- | :--- |
| **3.2.4 Complex Logic Filters** | Advanced Selection | `&&`; `||`; Environment Vars; Cross-referencing | Combining conditions. |
| **[[3.2.4.1 Compound Conditions]]** | Syntax | `A && B`; `A || B`; Chaining logic | AND and OR. |
| **[[3.2.4.2 Environmental Logic]]** | Dev Mode | `process.env.ELEVENTY_ENV`; Showing drafts only in dev | Show drafts only locally. |
| **[[3.2.4.3 Tag Intersection]]** | Precision | Finding items that have *both* tag A AND tag B | Find overlapping tags. |
| **[[3.2.4.4 Cross-Referencing]]** | Relationship | "Posts by the same author"; Linking related items | Finding related items. |
| **[[3.2.4.5 Debugging Complex Filters]]** | Troubleshooting | Breaking conditions into steps; Logging intermediate results | Debug one step at a time. |

# 3.2.4 Complex Logic Filters

Real-world requirements are rarely simple. "Show me all **Featured** posts from **2023** that are **not Drafts**" requires combining multiple conditions.

---

## 3.2.4.1 Compound Conditions

JavaScript's standard logical operators work here.

*   `&&` (AND): Both conditions must be true.
*   `||` (OR): At least one condition must be true.
*   `!` (NOT): Inverts a condition.

**Example**: Featured posts from 2023 that are not drafts.
```javascript
eleventyConfig.addCollection("special", collection => {
  return collection.getAll().filter(item => {
    const year = item.date.getFullYear();
    const isFeatured = item.data.featured === true;
    const isNotDraft = item.data.draft !== true;
    
    return year === 2023 && isFeatured && isNotDraft;
  });
});
```

---

## 3.2.4.2 Environmental Logic (Dev Mode)

You often want to show Drafts during development but hide them in production builds.

```javascript
const isProduction = process.env.ELEVENTY_ENV === "production";

eleventyConfig.addCollection("posts", collection => {
  return collection.getFilteredByTag("post").filter(item => {
    // If production, hide drafts. Otherwise, show everything.
    if (isProduction) {
      return item.data.draft !== true;
    }
    return true;
  });
});
```

Set the environment variable in your build script:
`ELEVENTY_ENV=production npx @11ty/eleventy`

---

## 3.2.4.3 Tag Intersection

Sometimes you need items that have **multiple** tags.

**Goal**: Posts tagged *both* "React" AND "Tutorial".

```javascript
eleventyConfig.addCollection("reactTutorials", collection => {
  return collection.getAll().filter(item => {
    const tags = item.data.tags || [];
    return tags.includes("react") && tags.includes("tutorial");
  });
});
```

---

## 3.2.4.4 Cross-Referencing (Related Posts)

A more advanced pattern is to find items related to another item.

**Goal**: "Other posts by this author" (Assuming `authorSlug` is set).

This is typically done in a filter, not a collection, because it's dynamic per page.

```javascript
eleventyConfig.addFilter("relatedByAuthor", (collections, currentPost) => {
  return collections.getFilteredByTag("post").filter(item => {
    // Same author, but not the same post
    return item.data.authorSlug === currentPost.data.authorSlug
           && item.url !== currentPost.url;
  });
});
```

---

## 3.2.4.5 Debugging Complex Filters

When a complex filter returns 0 results and you expect more, break it down.

```javascript
return collection.getAll().filter(item => {
  const condA = item.data.featured === true;
  const condB = item.date.getFullYear() === 2023;
  const condC = !item.data.draft;
  
  console.log(item.inputPath, { condA, condB, condC });
  
  return condA && condB && condC;
});
```

This will print each file with which conditions passed/failed.

---

## Quick Reference

| Operator | Meaning | Example |
| :--- | :--- | :--- |
| `&&` | AND | `a && b` |
| `\|\|` | OR | `a \|\| b` |
| `!` | NOT | `!a` |
| `===` | Strict Equals | `a === true` |
| `!==` | Strict Not Equals | `a !== true` |
