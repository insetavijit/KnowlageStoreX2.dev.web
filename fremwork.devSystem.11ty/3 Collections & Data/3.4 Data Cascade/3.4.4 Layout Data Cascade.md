# Layout Data Cascade: Inheritance Through Wrappers

Layouts don't just wrap content visually—they provide **data defaults** that content can inherit or override. Understanding this flow is essential for designing consistent templates without repetition.

---

## The Fundamental Principle: Layouts Provide Defaults

When a content file uses a layout, it inherits all front matter variables from that layout. This enables "set it once, use everywhere" patterns.

```
Layout: showSidebar: true
    │
    └── Content: (no showSidebar defined)
                 └── Inherits showSidebar: true
```

---

## Basic Inheritance

**Layout (`_includes/base.njk`):**
```yaml
---
showFooter: true
favIcon: "/favicon.ico"
---
```

**Content (`about.md`):**
```yaml
---
layout: base.njk
title: "About Us"
---
```

**Available in `about.md` template:**
```javascript
{
  layout: "base.njk",
  title: "About Us",
  showFooter: true,      // Inherited from layout
  favIcon: "/favicon.ico" // Inherited from layout
}
```

The content file only needs to define what's unique. Everything else flows from the layout.

---

## Shadowing (Override)

When content defines the same key as its layout, content wins:

**Layout:**
```yaml
---
author: "Site Admin"
---
```

**Content:**
```yaml
---
layout: base.njk
author: "Guest Writer"
---
```

**Result:**
```javascript
{ author: "Guest Writer" }  // Content overrides layout
```

This is "shadowing"—the local variable hides the inherited one.

---

## Chained Layouts

Layouts can use other layouts, creating inheritance chains:

```
base.njk → page.njk → post.njk → article.md
```

Data flows **from outermost to innermost**, with innermost winning conflicts:

```
base.njk:   siteName: "My Blog"
page.njk:   showNav: true
post.njk:   showDate: true, showNav: false
article.md: title: "Hello"
```

**Final merged data for `article.md`:**
```javascript
{
  siteName: "My Blog",  // From base.njk
  showNav: false,       // post.njk overrides page.njk
  showDate: true,       // From post.njk
  title: "Hello"        // From content
}
```

Each step closer to the content file takes priority.

---

## The Title Pattern (Common Trap)

A frequent confusion involves title handling:

**Layout:**
```yaml
---
title: "Default Page Title"
---
<!DOCTYPE html>
<html>
<head>
  <title>{{ title }}</title>
</head>
```

**Content:**
```yaml
---
layout: base.njk
title: "My Specific Page"
---
```

**Expected Behavior:** Page title is "My Specific Page" ✓

**Problem Scenario:**
```yaml
---
layout: base.njk
---
# Welcome to My Page
```

If no `title` is defined in content, the layout's "Default Page Title" appears. This is often wrong for SEO. 

**Solution:** Use computed data to extract titles from headings, or enforce that all content files define `title`.

---

## Layout Data Is NOT Available in Layout Itself

A subtlety: When you're inside the layout template, you see the **merged** data (layout + content). The layout doesn't see only its own front matter—it sees everything already combined.

```html
<!-- _includes/base.njk -->
---
defaultBg: "light"
---
<body class="bg-{{ defaultBg }}">
  <!-- If content.md defines defaultBg: "dark", 
       this outputs "bg-dark" not "bg-light" -->
```

This is usually the desired behavior, but be aware when debugging.

---

## Common Pitfalls and Solutions

**Problem:** Layout variable is undefined in content template.

**Cause:** The variable might be defined in a parent layout that the current layout doesn't use.

**Solution:** Trace the full layout chain and verify each link.

---

**Problem:** Content can't "unset" a layout variable.

**Cause:** Setting `key: null` still counts as "defined" and shadows the layout value.

**Solution:** Use computed data to handle conditional logic, or adjust your data structure.

---

**Problem:** Different post types need different default values.

**Solution:** Create specialized layouts (`post.njk`, `tutorial.njk`) that each define appropriate defaults, while sharing a common base through layout chaining.

---

## Quick Reference

| Scenario | Result |
| :--- | :--- |
| **Key in layout only** | Content inherits it |
| **Key in content only** | Content uses its own value |
| **Key in both** | Content value wins |
| **Chained layouts** | Innermost layout (closest to content) wins |

---

_This guide covers layout data inheritance. Natural progressions include **computed data for dynamic defaults**, **layout chaining patterns**, and **debugging inherited values**._
